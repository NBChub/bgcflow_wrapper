
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://NBChub.github.io/bgcflow_wrapper/0.5.1.dev/api/">
      
      
        <link rel="prev" href="../tutorial/">
      
      
        <link rel="next" href="../contributing/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.47">
    
    
      
        <title>Modules - bgcflow_wrapper</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bgcflow" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="bgcflow_wrapper" class="md-header__button md-logo" aria-label="bgcflow_wrapper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            bgcflow_wrapper
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NBChub/bgcflow_wrapper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    bgcflow_wrapper
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../tutorial/" class="md-tabs__link">
        
  
    
  
  Tutorial

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Modules

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contributing/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../authors/" class="md-tabs__link">
        
  
    
  
  Authors

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../history/" class="md-tabs__link">
        
  
    
  
  History

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="bgcflow_wrapper" class="md-nav__button md-logo" aria-label="bgcflow_wrapper" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    bgcflow_wrapper
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NBChub/bgcflow_wrapper" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    bgcflow_wrapper
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bgcflow" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.bgcflow" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bgcflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.cloner" class="md-nav__link">
    <span class="md-ellipsis">
      cloner()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.deployer" class="md-nav__link">
    <span class="md-ellipsis">
      deployer()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.get_all_rules" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_rules()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.snakemake_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      snakemake_wrapper()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.metabase" class="md-nav__link">
    <span class="md-ellipsis">
      metabase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metabase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.sync_dbt_models_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      sync_dbt_models_to_metabase()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.upload_and_sync_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      upload_and_sync_to_metabase()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.upload_dbt_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      upload_dbt_to_metabase()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.mkdocs" class="md-nav__link">
    <span class="md-ellipsis">
      mkdocs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mkdocs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class" class="md-nav__link">
    <span class="md-ellipsis">
      Dict2Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dict2Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class.print_references" class="md-nav__link">
    <span class="md-ellipsis">
      print_references()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.generate_mkdocs_report" class="md-nav__link">
    <span class="md-ellipsis">
      generate_mkdocs_report()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.load_project_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      load_project_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.signal_handler" class="md-nav__link">
    <span class="md-ellipsis">
      signal_handler()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.write_mkdocs_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_mkdocs_file()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.projects_util" class="md-nav__link">
    <span class="md-ellipsis">
      projects_util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="projects_util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.bgcflow_init" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow_init()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.copy_final_output" class="md-nav__link">
    <span class="md-ellipsis">
      copy_final_output()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.generate_global_config" class="md-nav__link">
    <span class="md-ellipsis">
      generate_global_config()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.generate_project" class="md-nav__link">
    <span class="md-ellipsis">
      generate_project()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.projects_util" class="md-nav__link">
    <span class="md-ellipsis">
      projects_util()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../authors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    History
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bgcflow" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.bgcflow" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bgcflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.cloner" class="md-nav__link">
    <span class="md-ellipsis">
      cloner()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.deployer" class="md-nav__link">
    <span class="md-ellipsis">
      deployer()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.get_all_rules" class="md-nav__link">
    <span class="md-ellipsis">
      get_all_rules()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.bgcflow.snakemake_wrapper" class="md-nav__link">
    <span class="md-ellipsis">
      snakemake_wrapper()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.cli" class="md-nav__link">
    <span class="md-ellipsis">
      cli
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.metabase" class="md-nav__link">
    <span class="md-ellipsis">
      metabase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metabase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.sync_dbt_models_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      sync_dbt_models_to_metabase()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.upload_and_sync_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      upload_and_sync_to_metabase()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.metabase.upload_dbt_to_metabase" class="md-nav__link">
    <span class="md-ellipsis">
      upload_dbt_to_metabase()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.mkdocs" class="md-nav__link">
    <span class="md-ellipsis">
      mkdocs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mkdocs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class" class="md-nav__link">
    <span class="md-ellipsis">
      Dict2Class
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dict2Class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.Dict2Class.print_references" class="md-nav__link">
    <span class="md-ellipsis">
      print_references()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.generate_mkdocs_report" class="md-nav__link">
    <span class="md-ellipsis">
      generate_mkdocs_report()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.load_project_metadata" class="md-nav__link">
    <span class="md-ellipsis">
      load_project_metadata()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.signal_handler" class="md-nav__link">
    <span class="md-ellipsis">
      signal_handler()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.mkdocs.write_mkdocs_file" class="md-nav__link">
    <span class="md-ellipsis">
      write_mkdocs_file()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bgcflow.projects_util" class="md-nav__link">
    <span class="md-ellipsis">
      projects_util
    </span>
  </a>
  
    <nav class="md-nav" aria-label="projects_util">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.bgcflow_init" class="md-nav__link">
    <span class="md-ellipsis">
      bgcflow_init()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.copy_final_output" class="md-nav__link">
    <span class="md-ellipsis">
      copy_final_output()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.generate_global_config" class="md-nav__link">
    <span class="md-ellipsis">
      generate_global_config()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.generate_project" class="md-nav__link">
    <span class="md-ellipsis">
      generate_project()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgcflow.projects_util.projects_util" class="md-nav__link">
    <span class="md-ellipsis">
      projects_util()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Modules</h1>

<div class="doc doc-object doc-module">

<a id="bgcflow"></a>
    <div class="doc doc-contents first">

      <p>Top-level package for bgcflow_wrapper.</p>



  <div class="doc doc-children">













  <div class="doc doc-object doc-module">



<h2 id="bgcflow.bgcflow" class="doc doc-heading">
        <code>bgcflow</code>



<a href="#bgcflow.bgcflow" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Main module.</p>



  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="bgcflow.bgcflow.cloner" class="doc doc-heading">
<code class="highlight language-python"><span class="n">cloner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.bgcflow.cloner" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Clone the BGCFlow repository to a specified destination.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for the cloning.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/bgcflow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">cloner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clone the BGCFlow repository to a specified destination.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword arguments for the cloning.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">destination_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">])</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cloning BGCFlow to </span><span class="si">{</span><span class="n">destination_dir</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">destination_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">Repo</span><span class="o">.</span><span class="n">clone_from</span><span class="p">(</span>
            <span class="s2">&quot;https://github.com/NBChub/bgcflow.git&quot;</span><span class="p">,</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">]),</span>
            <span class="n">branch</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">GitCommandError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Oops, it seems </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;destination&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> already exists and is not an empty directory.&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.bgcflow.deployer" class="doc doc-heading">
<code class="highlight language-python"><span class="n">deployer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.bgcflow.deployer" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Deploy the BGCFlow repository to a specified destination using Snakedeploy.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for the deployment.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/bgcflow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">deployer</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deploy the BGCFlow repository to a specified destination using Snakedeploy.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword arguments for the deployment.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dplyr</span><span class="p">(</span>
        <span class="s2">&quot;https://github.com/NBChub/bgcflow.git&quot;</span><span class="p">,</span>
        <span class="n">branch</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;branch&quot;</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bgcflow&quot;</span><span class="p">,</span>
        <span class="n">dest_path</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">]),</span>
        <span class="n">tag</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;tag&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.bgcflow.get_all_rules" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_all_rules</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.bgcflow.get_all_rules" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Print information about available rules in the BGCFlow repository.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for the function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/bgcflow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_rules</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Print information about available rules in the BGCFlow repository.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword arguments for the function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcflow_dir&quot;</span><span class="p">])</span>
    <span class="n">rule_file</span> <span class="o">=</span> <span class="n">path</span> <span class="o">/</span> <span class="s2">&quot;workflow/rules.yaml&quot;</span>

    <span class="k">if</span> <span class="n">rule_file</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">rule_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;describe&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">rule_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;describe&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Description for </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">rule_name</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cite&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">rule_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cite&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Citations for </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
                <span class="p">[</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">rule_name</span><span class="p">][</span><span class="s2">&quot;references&quot;</span><span class="p">]]</span>

            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;describe&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cite&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span>
            <span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Printing available rules:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">rule_name</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;describe&quot;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cite&quot;</span><span class="p">]]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span>
            <span class="p">]</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;ERROR: Cannot find rule </span><span class="si">{</span><span class="n">rule_name</span><span class="si">}</span><span class="s2"> in dictionary. Find available rules with `bgcflow rules`.&quot;</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;ERROR: Cannot find BGCFlow directory.</span><span class="se">\n</span><span class="s2">Point to the right directory using `--bgcflow_dir &lt;destination&gt;` or clone BGCFlow using `bgcflow clone &lt;destination&gt;`.&quot;</span>
        <span class="p">)</span>

    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.bgcflow.snakemake_wrapper" class="doc doc-heading">
<code class="highlight language-python"><span class="n">snakemake_wrapper</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.bgcflow.snakemake_wrapper" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Wrapper function for running Snakemake with BGCFlow.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for Snakemake and BGCFlow.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td></td>
      <td><p>None</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/bgcflow.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">snakemake_wrapper</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper function for running Snakemake with BGCFlow.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword arguments for Snakemake and BGCFlow.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="s2">&quot;Empty process catcher&quot;</span>

    <span class="n">dryrun</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">touch</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">unlock</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">until</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">profile</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">antismash_mode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;antismash_mode&quot;</span><span class="p">]</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;BGCFLOW_ANTISMASH_MODE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">antismash_mode</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dryrun&quot;</span><span class="p">]:</span>
        <span class="n">dryrun</span> <span class="o">=</span> <span class="s2">&quot;--dryrun&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;touch&quot;</span><span class="p">]:</span>
        <span class="n">touch</span> <span class="o">=</span> <span class="s2">&quot;--touch&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;unlock&quot;</span><span class="p">]:</span>
        <span class="n">unlock</span> <span class="o">=</span> <span class="s2">&quot;--unlock&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;until&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">until</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;--until </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;until&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;profile&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;--profile </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;monitor_off&quot;</span><span class="p">]:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Monitoring BGCFlow jobs with Panoptes...&quot;</span><span class="p">)</span>
        <span class="c1"># Run Panoptes if not yet run</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;wms_monitor&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wms_monitor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/api/service-info&quot;</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;running&quot;</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Panoptes already </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wms_monitor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>  <span class="c1"># This is the correct syntax</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Running Panoptes to monitor BGCFlow jobs at </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wms_monitor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="p">[</span><span class="s2">&quot;panoptes&quot;</span><span class="p">,</span> <span class="s2">&quot;--port&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)],</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span>
            <span class="p">)</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Panoptes job id: </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Connect to Panoptes</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot;Connecting to Panoptes...&quot;</span><span class="p">)</span>
        <span class="n">ctr</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">tries</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wms_monitor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/api/service-info&quot;</span><span class="p">)</span>
                <span class="n">status</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s2">&quot;running&quot;</span><span class="p">:</span>
                    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Panoptes status: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>  <span class="c1"># This is the correct syntax</span>
                <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrying to connect: </span><span class="si">{</span><span class="n">ctr</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
                <span class="n">ctr</span> <span class="o">=</span> <span class="n">ctr</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Check Snakefile</span>
    <span class="n">valid_workflows</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;Snakefile&quot;</span><span class="p">:</span> <span class="s2">&quot;Main BGCFlow snakefile for genome mining&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BGC&quot;</span><span class="p">:</span> <span class="s2">&quot;Subworkflow for comparative analysis of BGCs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Report&quot;</span><span class="p">:</span> <span class="s2">&quot;Build a static html report of a BGCFlow run&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Database&quot;</span><span class="p">:</span> <span class="s2">&quot;Build a DuckDB database for a BGCFlow run&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Metabase&quot;</span><span class="p">:</span> <span class="s2">&quot;Run a metabase server for visual exploration of the DuckDB database&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lsabgc&quot;</span><span class="p">:</span> <span class="s2">&quot;Run population genetic and evolutionary analysis with lsaBGC-Easy.py using BiG-SCAPE output&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ppanggolin&quot;</span><span class="p">:</span> <span class="s2">&quot;Build pangenome graph and detect region of genome plasticity with PPanGGOLiN&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">bgcflow_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcflow_dir&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;workflow&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;workflow/Snakefile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/BGC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/Report&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/Database&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/Metabase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/lsabgc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;workflow/ppanggolin&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">snakefile</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;workflow&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;workflow&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;Snakefile&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BGC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Report&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Database&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Metabase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lsabgc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ppanggolin&quot;</span><span class="p">,</span>
    <span class="p">]:</span>
        <span class="n">snakefile</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;workflow/</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;workflow&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">snakefile</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;workflow&quot;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">snakefile</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Snakefile </span><span class="si">{</span><span class="n">snakefile</span><span class="si">}</span><span class="s2"> does not exist. Available workflows are:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">valid_workflows</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="p">)</span>

    <span class="c1"># Run Snakemake</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cores&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">WARNING: Number of cores inputted (</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cores&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">) is higher than the number of available cores (</span><span class="si">{</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;DEBUG: Setting number of cores to available cores: </span><span class="si">{</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cores&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DEBUG: Using </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cores&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span><span class="si">}</span><span class="s2"> available cores</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="n">snakemake_command</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;cd </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;bgcflow_dir&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &amp;&amp; snakemake --snakefile </span><span class="si">{</span><span class="n">snakefile</span><span class="si">}</span><span class="s2"> --use-conda --keep-going --rerun-incomplete --rerun-triggers mtime -c </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cores&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">dryrun</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">touch</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">until</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">unlock</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">profile</span><span class="si">}</span><span class="s2"> --wms-monitor </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wms_monitor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running Snakemake with command:</span><span class="se">\n</span><span class="si">{</span><span class="n">snakemake_command</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">snakemake_command</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Kill Panoptes</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stopping panoptes server: PID </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">UnboundLocalError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="bgcflow.cli" class="doc doc-heading">
        <code>cli</code>



<a href="#bgcflow.cli" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Console script for bgcflow.</p>



  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="bgcflow.metabase" class="doc doc-heading">
        <code>metabase</code>



<a href="#bgcflow.metabase" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">








  <div class="doc doc-object doc-function">



<h3 id="bgcflow.metabase.sync_dbt_models_to_metabase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sync_dbt_models_to_metabase</span><span class="p">(</span><span class="n">dbt_dir</span><span class="p">,</span> <span class="n">dbt_database</span><span class="p">,</span> <span class="n">metabase_host</span><span class="p">,</span> <span class="n">metabase_database</span><span class="p">,</span> <span class="n">metabase_user</span><span class="p">,</span> <span class="n">metabase_password</span><span class="p">,</span> <span class="n">dbt_schema</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">metabase_http</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dbt_excludes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#bgcflow.metabase.sync_dbt_models_to_metabase" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Synchronizes dbt models to Metabase using the dbt-metabase package.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>dbt_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the dbt project directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbt_database</code></td>
        <td><code>str</code></td>
        <td><p>The name of the dbt database to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_host</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the Metabase server.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_user</code></td>
        <td><code>str</code></td>
        <td><p>The username of the Metabase account to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_password</code></td>
        <td><code>str</code></td>
        <td><p>The password of the Metabase account to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_database</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Metabase database to use.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbt_schema</code></td>
        <td><code>str</code></td>
        <td><p>The name of the dbt schema to use. Defaults to "main".</p></td>
        <td><code>&#39;main&#39;</code></td>
      </tr>
      <tr>
        <td><code>metabase_http</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use HTTP instead of HTTPS for the Metabase connection. Defaults to False.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The output of the dbt-metabase command as a string.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/metabase.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sync_dbt_models_to_metabase</span><span class="p">(</span>
    <span class="n">dbt_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbt_database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_database</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbt_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">metabase_http</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dbt_excludes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Synchronizes dbt models to Metabase using the dbt-metabase package.</span>

<span class="sd">    Args:</span>
<span class="sd">        dbt_dir (str): The path to the dbt project directory.</span>
<span class="sd">        dbt_database (str): The name of the dbt database to use.</span>
<span class="sd">        metabase_host (str): The URL of the Metabase server.</span>
<span class="sd">        metabase_user (str): The username of the Metabase account to use.</span>
<span class="sd">        metabase_password (str): The password of the Metabase account to use.</span>
<span class="sd">        metabase_database (str): The name of the Metabase database to use.</span>
<span class="sd">        dbt_schema (str, optional): The name of the dbt schema to use. Defaults to &quot;main&quot;.</span>
<span class="sd">        metabase_http (bool, optional): Whether to use HTTP instead of HTTPS for the Metabase connection. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The output of the dbt-metabase command as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot; - Synchronizing dbt models schema to Metabase...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">metabase_http</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot; - Connecting with HTTP method...&quot;</span><span class="p">)</span>
        <span class="n">metabase_http</span> <span class="o">=</span> <span class="s2">&quot;--metabase_http&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot; - Connecting with HTTPS method...&quot;</span><span class="p">)</span>
        <span class="n">metabase_http</span> <span class="o">=</span> <span class="s2">&quot;--metabase_https&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;dbt-metabase&quot;</span><span class="p">,</span>
        <span class="s2">&quot;models&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--dbt_path&quot;</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">dbt_dir</span><span class="p">),</span>
        <span class="s2">&quot;--dbt_database&quot;</span><span class="p">,</span>
        <span class="n">dbt_database</span><span class="p">,</span>
        <span class="s2">&quot;--metabase_host&quot;</span><span class="p">,</span>
        <span class="n">metabase_host</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;--metabase_user&quot;</span><span class="p">,</span>
        <span class="n">metabase_user</span><span class="p">,</span>
        <span class="s2">&quot;--metabase_password&quot;</span><span class="p">,</span>
        <span class="n">metabase_password</span><span class="p">,</span>
        <span class="s2">&quot;--metabase_database&quot;</span><span class="p">,</span>
        <span class="n">metabase_database</span><span class="p">,</span>
        <span class="s2">&quot;--dbt_schema&quot;</span><span class="p">,</span>
        <span class="n">dbt_schema</span><span class="p">,</span>
        <span class="n">metabase_http</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="k">if</span> <span class="n">dbt_excludes</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">dbt_excludes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">command</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;--dbt_excludes&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">dbt_excludes</span><span class="p">]</span>

    <span class="c1"># Run the command and capture the output</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="n">command</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">universal_newlines</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="c1">#  the output</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.metabase.upload_and_sync_to_metabase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_and_sync_to_metabase</span><span class="p">(</span><span class="n">project_name</span><span class="p">,</span> <span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">dbt_dir</span><span class="p">,</span> <span class="n">metabase_host</span><span class="p">,</span> <span class="n">mb_username</span><span class="p">,</span> <span class="n">mb_password</span><span class="p">,</span> <span class="n">dbt_schema</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="n">dbt_database</span><span class="o">=</span><span class="s1">&#39;dbt_bgcflow&#39;</span><span class="p">,</span> <span class="n">metabase_http</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metabase_database</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dbt_excludes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#bgcflow.metabase.upload_and_sync_to_metabase" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Uploads a DuckDB database file generated by dbt to Metabase and syncs the dbt models.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>project_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the project to upload to Metabase.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str</code></td>
        <td><p>The root directory of the BGCFlow project.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbt_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory containing the dbt project to upload. If None, the directory is inferred from the BGCFlow project directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_host</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the Metabase server.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mb_username</code></td>
        <td><code>str</code></td>
        <td><p>The Metabase username. If None, the user will be prompted to enter their username.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mb_password</code></td>
        <td><code>str</code></td>
        <td><p>The Metabase password. If None, the user will be prompted to enter their password.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbt_schema</code></td>
        <td><code>str</code></td>
        <td><p>The name of the dbt schema to use.</p></td>
        <td><code>&#39;main&#39;</code></td>
      </tr>
      <tr>
        <td><code>dbt_database</code></td>
        <td><code>str</code></td>
        <td><p>The name of the dbt database to use.</p></td>
        <td><code>&#39;dbt_bgcflow&#39;</code></td>
      </tr>
      <tr>
        <td><code>metabase_http</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use HTTP instead of HTTPS to connect to Metabase.</p></td>
        <td><code>True</code></td>
      </tr>
      <tr>
        <td><code>metabase_database</code></td>
        <td><code>str</code></td>
        <td><p>The name of the Metabase database to use. If None, the project name is used.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The output of the dbt-metabase command as a string.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AssertionError</code></td>
        <td><p>If the dbt_dir or bgcflow_dir do not exist or are not directories.</p></td>
      </tr>
      <tr>
        <td><code>subprocess.CalledProcessError</code></td>
        <td><p>If the dbt-metabase command fails.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/metabase.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">upload_and_sync_to_metabase</span><span class="p">(</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bgcflow_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbt_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mb_username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mb_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbt_schema</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;main&quot;</span><span class="p">,</span>
    <span class="n">dbt_database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;dbt_bgcflow&quot;</span><span class="p">,</span>
    <span class="n">metabase_http</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">metabase_database</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dbt_excludes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads a DuckDB database file generated by dbt to Metabase and syncs the dbt models.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name (str): The name of the project to upload to Metabase.</span>
<span class="sd">        bgcflow_dir (str): The root directory of the BGCFlow project.</span>
<span class="sd">        dbt_dir (str): The directory containing the dbt project to upload. If None, the directory is inferred from the BGCFlow project directory.</span>
<span class="sd">        metabase_host (str): The URL of the Metabase server.</span>
<span class="sd">        mb_username (str): The Metabase username. If None, the user will be prompted to enter their username.</span>
<span class="sd">        mb_password (str): The Metabase password. If None, the user will be prompted to enter their password.</span>
<span class="sd">        dbt_schema (str): The name of the dbt schema to use.</span>
<span class="sd">        dbt_database (str): The name of the dbt database to use.</span>
<span class="sd">        metabase_http (bool): Whether to use HTTP instead of HTTPS to connect to Metabase.</span>
<span class="sd">        metabase_database (str): The name of the Metabase database to use. If None, the project name is used.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The output of the dbt-metabase command as a string.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If the dbt_dir or bgcflow_dir do not exist or are not directories.</span>
<span class="sd">        subprocess.CalledProcessError: If the dbt-metabase command fails.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># available dbt models in bgcflow_dbt-duckdb v0.2.1</span>
    <span class="n">dbt_model_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;query-bigslice&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bigfam_hits&quot;</span><span class="p">,</span> <span class="s2">&quot;bigfam_network&quot;</span><span class="p">],</span>
        <span class="s2">&quot;bigscape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bigscape_cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;bigscape_network&quot;</span><span class="p">,</span> <span class="s2">&quot;mibig_hits&quot;</span><span class="p">],</span>
        <span class="s2">&quot;checkm&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;checkm&quot;</span><span class="p">],</span>
        <span class="s2">&quot;seqfu&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;seqfu&quot;</span><span class="p">],</span>
        <span class="s2">&quot;antismash&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;genomes&quot;</span><span class="p">],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">dbt_excludes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dbt_excludes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dbt_excludes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dbt_excludes</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dbt_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">report_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">)</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;data/processed/</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Accessing BGCFlow report directory in: </span><span class="si">{</span><span class="n">report_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;metadata/dependency_versions.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">dependency_version</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">antismash_version</span> <span class="o">=</span> <span class="n">dependency_version</span><span class="p">[</span><span class="s2">&quot;antismash&quot;</span><span class="p">]</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - AntiSMASH version: </span><span class="si">{</span><span class="n">antismash_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">project_metadata_json</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;metadata/project_metadata.json&quot;</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Reading project metadata from: </span><span class="si">{</span><span class="n">project_metadata_json</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">project_metadata_json</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">project_metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">used_pipelines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">project_metadata</span><span class="p">[</span><span class="n">project_name</span><span class="p">][</span><span class="s2">&quot;rule_used&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Used pipelines: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">used_pipelines</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pipeline</span> <span class="ow">in</span> <span class="n">dbt_model_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">pipeline</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_pipelines</span><span class="p">:</span>
                <span class="n">dbt_excludes</span> <span class="o">+=</span> <span class="n">dbt_model_dict</span><span class="p">[</span><span class="n">pipeline</span><span class="p">]</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Excluding models for sync: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dbt_excludes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">dbt_dir</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;dbt/antiSMASH_</span><span class="si">{</span><span class="n">antismash_version</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dbt_dir</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Accessing dbt project directory in: </span><span class="si">{</span><span class="n">dbt_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; - Using all models for sync: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dbt_model_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">dbt_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dbt_dir</span><span class="p">)</span>

    <span class="c1"># Get Metabase session token</span>
    <span class="k">if</span> <span class="n">mb_username</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mb_username</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s2">&quot;Enter your Metabase username&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mb_password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mb_password</span> <span class="o">=</span> <span class="n">click</span><span class="o">.</span><span class="n">prompt</span><span class="p">(</span><span class="s2">&quot;Enter your Metabase password&quot;</span><span class="p">,</span> <span class="n">hide_input</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">response</span><span class="p">,</span> <span class="n">session_token</span> <span class="o">=</span> <span class="n">upload_dbt_to_metabase</span><span class="p">(</span>
        <span class="n">project_name</span><span class="p">,</span> <span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">dbt_dir</span><span class="p">,</span> <span class="n">metabase_host</span><span class="p">,</span> <span class="n">mb_username</span><span class="p">,</span> <span class="n">mb_password</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">metabase_database</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metabase_database</span> <span class="o">=</span> <span class="n">project_name</span>
        <span class="n">sync_dbt_models_to_metabase</span><span class="p">(</span>
            <span class="n">dbt_dir</span><span class="p">,</span>
            <span class="n">dbt_database</span><span class="p">,</span>
            <span class="n">metabase_host</span><span class="p">,</span>
            <span class="n">metabase_database</span><span class="p">,</span>
            <span class="n">mb_username</span><span class="p">,</span>
            <span class="n">mb_password</span><span class="p">,</span>
            <span class="n">dbt_schema</span><span class="p">,</span>
            <span class="n">metabase_http</span><span class="p">,</span>
            <span class="n">dbt_excludes</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.metabase.upload_dbt_to_metabase" class="doc doc-heading">
<code class="highlight language-python"><span class="n">upload_dbt_to_metabase</span><span class="p">(</span><span class="n">project_name</span><span class="p">,</span> <span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">dbt_dir</span><span class="p">,</span> <span class="n">metabase_host</span><span class="p">,</span> <span class="n">mb_username</span><span class="p">,</span> <span class="n">mb_password</span><span class="p">)</span></code>


<a href="#bgcflow.metabase.upload_dbt_to_metabase" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Uploads a DuckDB database file generated by dbt to Metabase.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>project_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the project to upload to Metabase.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the BGCflow directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dbt_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the dbt directory containing the DuckDB database file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>metabase_host</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the Metabase server.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mb_username</code></td>
        <td><code>str</code></td>
        <td><p>The username to use for authentication with Metabase.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>mb_password</code></td>
        <td><code>str</code></td>
        <td><p>The password to use for authentication with Metabase.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The HTTP status code of the request.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>AssertionError</code></td>
        <td><p>If the DuckDB database file does not exist or is not a regular file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/metabase.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">upload_dbt_to_metabase</span><span class="p">(</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">bgcflow_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dbt_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">metabase_host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mb_username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">mb_password</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uploads a DuckDB database file generated by dbt to Metabase.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name (str): The name of the project to upload to Metabase.</span>
<span class="sd">        bgcflow_dir (str): The path to the BGCflow directory.</span>
<span class="sd">        dbt_dir (str): The path to the dbt directory containing the DuckDB database file.</span>
<span class="sd">        metabase_host (str): The URL of the Metabase server.</span>
<span class="sd">        mb_username (str): The username to use for authentication with Metabase.</span>
<span class="sd">        mb_password (str): The password to use for authentication with Metabase.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The HTTP status code of the request.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If the DuckDB database file does not exist or is not a regular file.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">duckdb_path</span> <span class="o">=</span> <span class="n">dbt_dir</span> <span class="o">/</span> <span class="s2">&quot;dbt_bgcflow.duckdb&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">duckdb_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">duckdb_path</span><span class="si">}</span><span class="s2"> does not exist or is not a regular file&quot;</span>

    <span class="n">session_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metabase_host</span><span class="si">}</span><span class="s2">/api/session&quot;</span><span class="p">,</span>
        <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">mb_username</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">mb_password</span><span class="p">},</span>
    <span class="p">)</span>
    <span class="n">session_token</span> <span class="o">=</span> <span class="n">session_response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="c1"># Check if database already exists</span>
    <span class="n">database_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metabase_host</span><span class="si">}</span><span class="s2">/api/database&quot;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-Metabase-Session&quot;</span><span class="p">:</span> <span class="n">session_token</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">databases</span> <span class="o">=</span> <span class="n">database_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">database_id</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">databases</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">db</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">db</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">project_name</span><span class="p">:</span>
                    <span class="n">database_id</span> <span class="o">=</span> <span class="n">db</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
                    <span class="k">break</span>

    <span class="c1"># Prompt user to continue or cancel upload</span>
    <span class="k">if</span> <span class="n">database_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">user_input</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; - WARNING: A database with the name &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39; already exists in Metabase. Do you want to continue with the upload? (y/n) &quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">user_input</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="s2">&quot; - Database upload cancelled by user&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="c1"># Upload or update database in Metabase</span>
    <span class="k">if</span> <span class="n">database_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">database_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metabase_host</span><span class="si">}</span><span class="s2">/api/database&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-Metabase-Session&quot;</span><span class="p">:</span> <span class="n">session_token</span><span class="p">},</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;engine&quot;</span><span class="p">:</span> <span class="s2">&quot;duckdb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">project_name</span><span class="p">,</span>
                <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;database_file&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">duckdb_path</span><span class="o">.</span><span class="n">resolve</span><span class="p">())},</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">database_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Database &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39; uploaded successfully&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot; - Error uploading database &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">database_response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">database_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metabase_host</span><span class="si">}</span><span class="s2">/api/database/</span><span class="si">{</span><span class="n">database_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;X-Metabase-Session&quot;</span><span class="p">:</span> <span class="n">session_token</span><span class="p">},</span>
            <span class="n">json</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;engine&quot;</span><span class="p">:</span> <span class="s2">&quot;duckdb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">project_name</span><span class="p">,</span>
                <span class="s2">&quot;details&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;database_file&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">duckdb_path</span><span class="o">.</span><span class="n">resolve</span><span class="p">())},</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">database_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - Database &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39; updated successfully&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">click</span><span class="o">.</span><span class="n">echo</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot; - Error updating database &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">database_response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">database_response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">session_token</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="bgcflow.mkdocs" class="doc doc-heading">
        <code>mkdocs</code>



<a href="#bgcflow.mkdocs" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">














  <div class="doc doc-object doc-class">



<h3 id="bgcflow.mkdocs.Dict2Class" class="doc doc-heading">
        <code>
Dict2Class        </code>



<a href="#bgcflow.mkdocs.Dict2Class" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A class that converts a dictionary to an object with attributes.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_dict</code></td>
        <td><code>dict</code></td>
        <td><p>The dictionary to convert to an object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>      <div class="admonition methods">
<p class="admonition-title">Methods</p>
<p>print_references():
    Returns a formatted string of the <code>references</code> attribute of the object.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Dict2Class</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that converts a dictionary to an object with attributes.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict (dict): The dictionary to convert to an object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        All keys in the dictionary are converted to attributes of the object.</span>

<span class="sd">    Methods:</span>
<span class="sd">        print_references():</span>
<span class="sd">            Returns a formatted string of the `references` attribute of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the object with attributes from the dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            my_dict (dict): The dictionary to convert to an object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">print_references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a formatted string of the `references` attribute of the object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A formatted string of the `references` attribute of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">text</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h4 id="bgcflow.mkdocs.Dict2Class.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#bgcflow.mkdocs.Dict2Class.__init__" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Initializes the object with attributes from the dictionary.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>my_dict</code></td>
        <td><code>dict</code></td>
        <td><p>The dictionary to convert to an object.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes the object with attributes from the dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        my_dict (dict): The dictionary to convert to an object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="p">:</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h4 id="bgcflow.mkdocs.Dict2Class.print_references" class="doc doc-heading">
<code class="highlight language-python"><span class="n">print_references</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#bgcflow.mkdocs.Dict2Class.print_references" class="headerlink" title="Permanent link">&para;</a></h4>

    <div class="doc doc-contents ">

      <p>Returns a formatted string of the <code>references</code> attribute of the object.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>A formatted string of the <code>references</code> attribute of the object.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">print_references</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a formatted string of the `references` attribute of the object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A formatted string of the `references` attribute of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">references</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">text</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h3 id="bgcflow.mkdocs.generate_mkdocs_report" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_mkdocs_report</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8001</span><span class="p">,</span> <span class="n">fileserver</span><span class="o">=</span><span class="s1">&#39;http://localhost:8002&#39;</span><span class="p">,</span> <span class="n">ipynb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


<a href="#bgcflow.mkdocs.generate_mkdocs_report" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generates an MkDocs report for a BGCFlow project.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str</code></td>
        <td><p>The path to the BGCFlow project directory.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>project_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the BGCFlow project.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>port</code></td>
        <td><code>int</code></td>
        <td><p>The port number to use for the MkDocs server, by default 8001.</p></td>
        <td><code>8001</code></td>
      </tr>
      <tr>
        <td><code>fileserver</code></td>
        <td><code>str</code></td>
        <td><p>The URL of the file server to use, by default "http://localhost:8002".</p></td>
        <td><code>&#39;http://localhost:8002&#39;</code></td>
      </tr>
      <tr>
        <td><code>ipynb</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use IPython notebooks for the reports, by default True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_mkdocs_report</span><span class="p">(</span>
    <span class="n">bgcflow_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">8001</span><span class="p">,</span>
    <span class="n">fileserver</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8002&quot;</span><span class="p">,</span>
    <span class="n">ipynb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an MkDocs report for a BGCFlow project.</span>

<span class="sd">    Args:</span>
<span class="sd">        bgcflow_dir (str): The path to the BGCFlow project directory.</span>
<span class="sd">        project_name (str: The name of the BGCFlow project.</span>
<span class="sd">        port (int, optional): The port number to use for the MkDocs server, by default 8001.</span>
<span class="sd">        fileserver (str, optional): The URL of the file server to use, by default &quot;http://localhost:8002&quot;.</span>
<span class="sd">        ipynb (bool, optional): Whether to use IPython notebooks for the reports, by default True.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking input folder..&quot;</span><span class="p">)</span>

    <span class="c1"># is it a bgcflow data directory or just a result directory?</span>
    <span class="n">input_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">input_dir</span> <span class="o">/</span> <span class="s2">&quot;metadata/project_metadata.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">report_dir</span> <span class="o">=</span> <span class="n">input_dir</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">report_dir</span> <span class="o">=</span> <span class="n">input_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;data/processed/</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;metadata/project_metadata.json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">is_file</span><span class="p">(),</span> <span class="s2">&quot;Unable to find BGCFlow results&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found project_metadata. Using [</span><span class="si">{</span><span class="n">report_dir</span><span class="si">}</span><span class="s2">] as report directory.&quot;</span><span class="p">)</span>

    <span class="c1"># Get project metadata</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">load_project_metadata</span><span class="p">(</span><span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;metadata/project_metadata.json&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">p</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">project_name</span>
    <span class="p">),</span> <span class="s2">&quot;Project metadata does not match with user provided input!&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Project [</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">] was analysed using BGCFlow version </span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">bgcflow_version</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># available reports, check all output files</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Available reports: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">rule_used</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">rule_used</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># check available reports</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Preparing mkdocs config...&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ipynb</span><span class="p">:</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot;ipynb&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="s2">&quot;md&quot;</span>

    <span class="n">report_category_containers</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">rule_used</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">jupyter_template</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;docs/</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">extension</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="c1"># logging.debug(jupyter_template.is_file()) # TO DO ASSERT IPYNB FILES, THEY SHOULD BE IN THE DOCS</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding report [</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">jupyter_template</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
        <span class="n">report_category</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">report_category</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">report_category_containers</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">report_category_containers</span><span class="p">[</span><span class="n">report_category</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">report_category_containers</span><span class="p">[</span><span class="n">report_category</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">r</span><span class="p">:</span> <span class="n">jupyter_template</span><span class="o">.</span><span class="n">name</span><span class="p">})</span>

    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">report_category_containers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">mkdocs_template</span><span class="p">[</span><span class="s2">&quot;nav&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="p">})</span>

    <span class="c1"># write mkdocs template</span>
    <span class="n">mkdocs_yml</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;mkdocs.yml&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating mkdocs config at: </span><span class="si">{</span><span class="n">mkdocs_yml</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">write_mkdocs_file</span><span class="p">(</span><span class="n">mkdocs_template</span><span class="p">,</span> <span class="n">mkdocs_yml</span><span class="p">,</span> <span class="s2">&quot;yaml&quot;</span><span class="p">)</span>

    <span class="c1"># Generate index.md</span>
    <span class="n">docs_dir</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;docs&quot;</span>
    <span class="n">docs_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">mkdocs_index</span> <span class="o">=</span> <span class="n">docs_dir</span> <span class="o">/</span> <span class="s2">&quot;index.md&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating homepage at: </span><span class="si">{</span><span class="n">mkdocs_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">df_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;BGCFlow_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">index</span>
    <span class="n">df_results</span> <span class="o">=</span> <span class="n">df_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;BGCFlow_rules&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span>
        <span class="n">drop</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">df_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;BGCFlow_rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">/)&quot;</span> <span class="o">+</span> <span class="s2">&quot;{.md-button}&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df_results</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;BGCFlow_rules&quot;</span><span class="p">]</span>
    <span class="p">]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;p_name&quot;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;p_description&quot;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">description</span><span class="p">,</span>
        <span class="s2">&quot;p_sample_size&quot;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">sample_size</span><span class="p">,</span>
        <span class="s2">&quot;p_references&quot;</span><span class="p">:</span> <span class="n">p</span><span class="o">.</span><span class="n">references</span><span class="p">,</span>
        <span class="s2">&quot;rule_table&quot;</span><span class="p">:</span> <span class="n">df_results</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">j2_template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">index_template</span><span class="p">)</span>

    <span class="n">write_mkdocs_file</span><span class="p">(</span><span class="n">j2_template</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">mkdocs_index</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">)</span>

    <span class="c1"># generate main.py macros</span>
    <span class="n">mkdocs_py</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;main.py&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating python macros at: </span><span class="si">{</span><span class="n">mkdocs_py</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">j2_template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="n">macros_template</span><span class="p">)</span>
    <span class="n">write_mkdocs_file</span><span class="p">(</span>
        <span class="n">j2_template</span><span class="o">.</span><span class="n">render</span><span class="p">({</span><span class="s2">&quot;file_server&quot;</span><span class="p">:</span> <span class="n">fileserver</span><span class="p">}),</span> <span class="n">mkdocs_py</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span>
    <span class="p">)</span>

    <span class="c1"># generate custom javascripts</span>
    <span class="c1"># script_dir = docs_dir / &quot;scripts&quot;</span>
    <span class="c1"># script_dir.mkdir(parents=True, exist_ok=True)</span>
    <span class="c1"># logging.info(f&quot;Generating custom site javascripts at: {script_dir / &#39;site.js&#39;}&quot;)</span>
    <span class="c1"># with open(script_dir / &#39;site.js&#39;, &quot;w&quot;) as f:</span>
    <span class="c1">#    f.write(script_js)</span>

    <span class="c1"># extend main html</span>
    <span class="n">override_dir</span> <span class="o">=</span> <span class="n">report_dir</span> <span class="o">/</span> <span class="s2">&quot;overrides&quot;</span>
    <span class="n">override_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extends main html: </span><span class="si">{</span><span class="n">override_dir</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;main.html&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">override_dir</span> <span class="o">/</span> <span class="s2">&quot;main.html&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">main_html</span><span class="p">)</span>

    <span class="c1"># generate assets</span>
    <span class="n">asset_path</span> <span class="o">=</span> <span class="n">docs_dir</span> <span class="o">/</span> <span class="s2">&quot;assets/bgcflow&quot;</span>
    <span class="n">asset_path</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating assets...&quot;</span><span class="p">)</span>
    <span class="n">logo_path</span> <span class="o">=</span> <span class="n">asset_path</span> <span class="o">/</span> <span class="s2">&quot;BGCFlow_logo.svg&quot;</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;outputs/svg/BGCFlow_logo.svg&quot;</span><span class="p">,</span> <span class="n">logo_path</span><span class="p">)</span>

    <span class="c1"># generate symlink</span>
    <span class="c1"># for r in [&#39;antismash&#39;, &#39;bigscape&#39;]:</span>
    <span class="c1">#    target_path_raw = report_dir / r</span>
    <span class="c1">#    for target_path in target_path_raw.glob(&quot;*&quot;):</span>
    <span class="c1">#        if any(target_path.name.startswith(keywords) for keywords in [&#39;result&#39;, &#39;6&#39;]):</span>
    <span class="c1">#            if target_path.is_dir():</span>
    <span class="c1">#                symlink_path = asset_path / r</span>
    <span class="c1">#                if symlink_path.is_symlink():</span>
    <span class="c1">#                    symlink_path.unlink()</span>
    <span class="c1">#                symlink_path.symlink_to(target_path.resolve())</span>

    <span class="c1"># Running fileserver</span>
    <span class="k">if</span> <span class="n">fileserver</span> <span class="o">==</span> <span class="s2">&quot;http://localhost:8002&quot;</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;python&quot;</span><span class="p">,</span>
                <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
                <span class="s2">&quot;http.server&quot;</span><span class="p">,</span>
                <span class="s2">&quot;--directory&quot;</span><span class="p">,</span>
                <span class="n">report_dir</span><span class="p">,</span>
                <span class="n">fileserver</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">fs_run_by_bgcflow</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Running http file-server. Job id: </span><span class="si">{</span><span class="n">fs</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fs_run_by_bgcflow</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># dumping file server location</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;bgcflow_wrapper.log&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">log_port</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;report_server&quot;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span> <span class="s2">&quot;file_server&quot;</span><span class="p">:</span> <span class="n">fileserver</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">fs_run_by_bgcflow</span><span class="p">:</span>
            <span class="n">log_port</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">pid</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">log_port</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal_handler</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;(cd </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">report_dir</span><span class="p">)</span><span class="si">}</span><span class="s2"> &amp;&amp; mkdocs serve -a localhost:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">fs_run_by_bgcflow</span><span class="p">:</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="c1"># asset_path.rmdir()</span>
    <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">fs_run_by_bgcflow</span><span class="p">:</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">kill</span><span class="p">()</span>
        <span class="c1"># asset_path.rmdir()</span>
    <span class="k">return</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.mkdocs.load_project_metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">load_project_metadata</span><span class="p">(</span><span class="n">path_to_metadata</span><span class="p">)</span></code>


<a href="#bgcflow.mkdocs.load_project_metadata" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Loads project metadata from a JSON file and returns it as an object.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>path_to_metadata</code></td>
        <td><code>str or Path</code></td>
        <td><p>The path to the JSON file containing the project metadata.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Dict2Class</code></td>
      <td><p>An object representing the project metadata.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">load_project_metadata</span><span class="p">(</span><span class="n">path_to_metadata</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads project metadata from a JSON file and returns it as an object.</span>

<span class="sd">    Args:</span>
<span class="sd">        path_to_metadata (str or Path): The path to the JSON file containing the project metadata.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict2Class: An object representing the project metadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_to_metadata</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">project_metadata</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">project_metadata</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">project_metadata</span><span class="o">.</span><span class="n">keys</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Dict2Class</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.mkdocs.signal_handler" class="doc doc-heading">
<code class="highlight language-python"><span class="n">signal_handler</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">frame</span><span class="p">)</span></code>


<a href="#bgcflow.mkdocs.signal_handler" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>A signal handler function that prints a message and exits the program.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>signal</code></td>
        <td><code>int</code></td>
        <td><p>The signal number.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>frame</code></td>
        <td><code>FrameType</code></td>
        <td><p>The current stack frame.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">signal_handler</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A signal handler function that prints a message and exits the program.</span>

<span class="sd">    Args:</span>
<span class="sd">        signal (int): The signal number.</span>
<span class="sd">        frame (FrameType): The current stack frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Thank you for using BGCFlow Report!&quot;</span><span class="p">)</span>
    <span class="c1"># with open(&#39;bgcflow_wrapper.log&#39;, &quot;r&quot;) as f:</span>
    <span class="c1">#    log_port = json.load(f)</span>
    <span class="c1">#    os.kill(log_port[&#39;pid&#39;], signal.signal.SIGKILL)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.mkdocs.write_mkdocs_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_mkdocs_file</span><span class="p">(</span><span class="n">data_input</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span></code>


<a href="#bgcflow.mkdocs.write_mkdocs_file" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Writes data to a file in either YAML or plain text format.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_input</code></td>
        <td><code>dict or str</code></td>
        <td><p>The data to write to the file.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>output_file</code></td>
        <td><code>str or Path</code></td>
        <td><p>The path to the file to write.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>action</code></td>
        <td><code>str</code></td>
        <td><p>The action to perform. Either "yaml" to write the data in YAML format, or "write" to write the data as plain text.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/mkdocs.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">write_mkdocs_file</span><span class="p">(</span><span class="n">data_input</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes data to a file in either YAML or plain text format.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_input (dict or str): The data to write to the file.</span>
<span class="sd">        output_file (str or Path): The path to the file to write.</span>
<span class="sd">        action (str): The action to perform. Either &quot;yaml&quot; to write the data in YAML format, or &quot;write&quot; to write the data as plain text.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">output_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">overwrite</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;WARNING: </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2"> already exists. Do you want to overwrite it? (y/n) &quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">overwrite</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping file write.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># continue with writing the file</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;yaml&quot;</span><span class="p">:</span>
                    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data_input</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;write&quot;</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_input</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># continue with writing the file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;yaml&quot;</span><span class="p">:</span>
                <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data_input</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s2">&quot;write&quot;</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_input</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>



  <div class="doc doc-object doc-module">



<h2 id="bgcflow.projects_util" class="doc doc-heading">
        <code>projects_util</code>



<a href="#bgcflow.projects_util" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">




  <div class="doc doc-children">










  <div class="doc doc-object doc-function">



<h3 id="bgcflow.projects_util.bgcflow_init" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bgcflow_init</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span></code>


<a href="#bgcflow.projects_util.bgcflow_init" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initialize BGCFlow configuration and display available projects.</p>
<p>Initializes BGCFlow configuration based on the provided directory and global configuration path.
If the global configuration file exists, it lists the available projects.
If not, generates a global configuration file from the template and provides instructions for a test run.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str or pathlib.PosixPath</code></td>
        <td><p>The directory where the BGCFlow configuration is located.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>global_config</code></td>
        <td><code>str or pathlib.PosixPath</code></td>
        <td><p>The path to the global configuration file.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/projects_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bgcflow_init</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize BGCFlow configuration and display available projects.</span>

<span class="sd">    Initializes BGCFlow configuration based on the provided directory and global configuration path.</span>
<span class="sd">    If the global configuration file exists, it lists the available projects.</span>
<span class="sd">    If not, generates a global configuration file from the template and provides instructions for a test run.</span>

<span class="sd">    Args:</span>
<span class="sd">        bgcflow_dir (str or pathlib.PosixPath): The directory where the BGCFlow configuration is located.</span>
<span class="sd">        global_config (str or pathlib.PosixPath): The path to the global configuration file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if global config available</span>
    <span class="k">if</span> <span class="n">global_config</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="c1"># grab available projects</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found config file at: </span><span class="si">{</span><span class="n">global_config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">global_config</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">config_yaml</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">project_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">config_yaml</span><span class="p">[</span><span class="s2">&quot;projects&quot;</span><span class="p">]]</span>
            <span class="n">list_of_projects</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">project_names</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;pep&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pep&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">):</span>
                    <span class="n">pep</span> <span class="o">=</span> <span class="n">peppy</span><span class="o">.</span><span class="n">Project</span><span class="p">(</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]),</span> <span class="n">sample_table_index</span><span class="o">=</span><span class="s2">&quot;genome_id&quot;</span>
                    <span class="p">)</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">pep</span><span class="o">.</span><span class="n">name</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">pep</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;sample_table&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">]</span>
                <span class="n">list_of_projects</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_path</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available projects:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">list_of_projects</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">generate_global_config</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Do a test run by: `bgcflow run -n`&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.projects_util.copy_final_output" class="doc doc-heading">
<code class="highlight language-python"><span class="n">copy_final_output</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.projects_util.copy_final_output" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Copy final project output files to a specified destination.</p>
<p>This function facilitates the copying of processed project output files to a designated destination. It can
also preserve symbolic links during the copy process if specified.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword argument for the function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Keyword arguments:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str</code></td>
        <td><p>The directory where the BGCFlow configuration is located.</p></td>
      </tr>
      <tr>
        <td><code>project</code></td>
        <td><code>str</code></td>
        <td><p>The name of the project whose output should be copied.</p></td>
      </tr>
      <tr>
        <td><code>resolve_symlinks</code></td>
        <td><code>str</code></td>
        <td><p>Indicate whether to preserve symbolic links. Defaults to False.</p></td>
      </tr>
      <tr>
        <td><code>destination</code></td>
        <td><code>str</code></td>
        <td><p>The destination directory where the output should be copied.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/projects_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">copy_final_output</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Copy final project output files to a specified destination.</span>

<span class="sd">    This function facilitates the copying of processed project output files to a designated destination. It can</span>
<span class="sd">    also preserve symbolic links during the copy process if specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword argument for the function.</span>

<span class="sd">    Keyword arguments:</span>
<span class="sd">        bgcflow_dir (str): The directory where the BGCFlow configuration is located.</span>
<span class="sd">        project (str): The name of the project whose output should be copied.</span>
<span class="sd">        resolve_symlinks (str, optional): Indicate whether to preserve symbolic links. Defaults to False.</span>
<span class="sd">        destination (str): The destination directory where the output should be copied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bgcflow_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcflow_dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="n">project_output</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;data/processed/</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">project_output</span><span class="o">.</span><span class="n">is_dir</span><span class="p">()</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;ERROR: Cannot find project [</span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;project&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">] results. Run `bgcflow init` to find available projects.&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;resolve_symlinks&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;resolve_symlinks&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;True&quot;</span><span class="p">,</span>
            <span class="s2">&quot;False&quot;</span><span class="p">,</span>
        <span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;Invalid argument </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;resolve_symlinks&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> in --resolve-symlinks. Choose between &quot;True&quot; or &quot;False&quot;&#39;</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;resolve_symlinks&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
            <span class="n">resolve_symlinks</span> <span class="o">=</span> <span class="s2">&quot;-L&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resolve_symlinks</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">exclude_copy</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">project_output</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span><span class="si">}</span><span class="s2">/bigscape/*/cache&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;rsync&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-avPhr&quot;</span><span class="p">,</span>
        <span class="n">resolve_symlinks</span><span class="p">,</span>
        <span class="s2">&quot;--exclude&quot;</span><span class="p">,</span>
        <span class="n">exclude_copy</span><span class="p">,</span>
        <span class="nb">str</span><span class="p">(</span><span class="n">project_output</span><span class="p">),</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;destination&quot;</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Running command: </span><span class="si">{</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.projects_util.generate_global_config" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_global_config</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span></code>


<a href="#bgcflow.projects_util.generate_global_config" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate a BGCFlow global configuration file from a template.</p>
<p>Copies the template configuration file to the specified global configuration path.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str or pathlib.PosixPath</code></td>
        <td><p>The directory where the BGCFlow configuration is located.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>global_config</code></td>
        <td><code>str or pathlib.PosixPath</code></td>
        <td><p>The path to the global configuration file to be generated.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/projects_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_global_config</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a BGCFlow global configuration file from a template.</span>

<span class="sd">    Copies the template configuration file to the specified global configuration path.</span>

<span class="sd">    Args:</span>
<span class="sd">        bgcflow_dir (str or pathlib.PosixPath): The directory where the BGCFlow configuration is located.</span>
<span class="sd">        global_config (str or pathlib.PosixPath): The path to the global configuration file to be generated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generating config file from template at: </span><span class="si">{</span><span class="n">global_config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">template_config</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;.examples/_config_example.yaml&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">template_config</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
    <span class="p">),</span> <span class="s2">&quot;Cannot find template file. Are you using BGCFlow version &gt;= 0.4.1?&quot;</span>

    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">template_config</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span>

    <span class="c1"># scan for example projects</span>
    <span class="k">def</span> <span class="nf">copy_project_example</span><span class="p">(</span><span class="n">project_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scan global config for example projects and (sub projects) and copy them to the config directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">global_config</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">config_yaml</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">example_projects</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Path</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;pep&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">config_yaml</span><span class="p">[</span><span class="n">project_type</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;pep&quot;</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="s2">&quot;pep&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">example_project</span> <span class="ow">in</span> <span class="n">example_projects</span><span class="p">:</span>
            <span class="n">example_project_dir</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;.examples&quot;</span> <span class="o">/</span> <span class="n">example_project</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span>
            <span class="p">)</span>
            <span class="n">target_dir</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="n">example_project_dir</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">example_project</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;.examples&quot;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - WARNING: You are using BGCFlow version &lt;= 0.7.1. In the global config file (`</span><span class="si">{</span><span class="n">global_config</span><span class="si">}</span><span class="s2">`), please change the location of your `</span><span class="si">{</span><span class="n">example_project</span><span class="si">}</span><span class="s2">` to `config/</span><span class="si">{</span><span class="n">example_project</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">example_project</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">`.&quot;</span>
                <span class="p">)</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copytree</span><span class="p">(</span><span class="n">example_project_dir</span><span class="p">,</span> <span class="n">target_dir</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">project_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;projects&quot;</span><span class="p">,</span> <span class="s2">&quot;bgc_projects&quot;</span><span class="p">]:</span>
        <span class="n">copy_project_example</span><span class="p">(</span><span class="n">project_type</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.projects_util.generate_project" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_project</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">pep_version</span><span class="o">=</span><span class="s1">&#39;2.1.0&#39;</span><span class="p">,</span> <span class="n">use_project_rules</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">samples_csv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">prokka_db</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gtdb_tax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#bgcflow.projects_util.generate_project" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Generate a PEP project configuration in BGCFlow.</p>
<p>This function creates a configuration file for a Project Enhanced Pipelines (PEP)
project within the BGCFlow framework. It allows you to define various aspects of
the project, such as its name, version, description, sample data, custom annotations,
and more.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str or pathlib.PosixPath</code></td>
        <td><p>The directory where the BGCFlow configuration is located.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>project_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the project.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>pep_version</code></td>
        <td><code>str</code></td>
        <td><p>The version of the PEP specification. Defaults to "2.1.0".</p></td>
        <td><code>&#39;2.1.0&#39;</code></td>
      </tr>
      <tr>
        <td><code>use_project_rules</code></td>
        <td><code>bool</code></td>
        <td><p>Flag indicating whether to use project-specific rules. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>samples_csv</code></td>
        <td><code>pd.core.frame.DataFrame or str</code></td>
        <td><p>Sample data in Pandas DataFrame or path to a CSV file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>prokka_db</code></td>
        <td><code>str</code></td>
        <td><p>Path to a custom Prokka annotation file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>gtdb_tax</code></td>
        <td><code>str</code></td>
        <td><p>Path to a custom GTDB taxonomy file. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>description</code></td>
        <td><code>str</code></td>
        <td><p>Description for the project. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/projects_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_project</span><span class="p">(</span>
    <span class="n">bgcflow_dir</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">,</span>
    <span class="n">pep_version</span><span class="o">=</span><span class="s2">&quot;2.1.0&quot;</span><span class="p">,</span>
    <span class="n">use_project_rules</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">samples_csv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">prokka_db</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">gtdb_tax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a PEP project configuration in BGCFlow.</span>

<span class="sd">    This function creates a configuration file for a Project Enhanced Pipelines (PEP)</span>
<span class="sd">    project within the BGCFlow framework. It allows you to define various aspects of</span>
<span class="sd">    the project, such as its name, version, description, sample data, custom annotations,</span>
<span class="sd">    and more.</span>

<span class="sd">    Args:</span>
<span class="sd">        bgcflow_dir (str or pathlib.PosixPath): The directory where the BGCFlow configuration is located.</span>
<span class="sd">        project_name (str): The name of the project.</span>
<span class="sd">        pep_version (str, optional): The version of the PEP specification. Defaults to &quot;2.1.0&quot;.</span>
<span class="sd">        use_project_rules (bool, optional): Flag indicating whether to use project-specific rules. Defaults to False.</span>
<span class="sd">        samples_csv (pd.core.frame.DataFrame or str, optional): Sample data in Pandas DataFrame or path to a CSV file. Defaults to False.</span>
<span class="sd">        prokka_db (str, optional): Path to a custom Prokka annotation file. Defaults to False.</span>
<span class="sd">        gtdb_tax (str, optional): Path to a custom GTDB taxonomy file. Defaults to False.</span>
<span class="sd">        description (str, optional): Description for the project. Defaults to False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure bgcflow_dir is a pathlib.PosixPath</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">Path</span><span class="p">):</span>
        <span class="n">bgcflow_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">)</span>

    <span class="c1"># Define paths and template dictionary</span>
    <span class="n">global_config</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;config/config.yaml&quot;</span>
    <span class="n">template_dict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">project_name</span><span class="p">,</span>
        <span class="s2">&quot;pep_version&quot;</span><span class="p">:</span> <span class="n">pep_version</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;TO DO: give a description to your project&gt;&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sample_table&quot;</span><span class="p">:</span> <span class="s2">&quot;samples.csv&quot;</span><span class="p">,</span>
        <span class="s2">&quot;prokka-db&quot;</span><span class="p">:</span> <span class="s2">&quot;OPTIONAL: relative path to your `prokka-db.csv`&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gtdb-tax&quot;</span><span class="p">:</span> <span class="s2">&quot;OPTIONAL: relative path to your `gtdbtk.bac120.summary.tsv`&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Update template_dict with project rules if enabled</span>
    <span class="k">if</span> <span class="n">use_project_rules</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;workflow/rules.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">available_rules</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
            <span class="n">available_rules</span> <span class="o">=</span> <span class="p">{</span><span class="n">rule</span><span class="p">:</span> <span class="s2">&quot;FALSE&quot;</span> <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">available_rules</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>
            <span class="n">template_dict</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">available_rules</span>

    <span class="c1"># Create project directory</span>
    <span class="n">project_dir</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;config/</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">project_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Handle samples_csv input</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples_csv</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Generating samples file from Pandas DataFrame&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">samples_csv</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;genome_id&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">samples_csv</span><span class="o">.</span><span class="n">columns</span>
            <span class="o">==</span> <span class="p">[</span>
                <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                <span class="s2">&quot;organism&quot;</span><span class="p">,</span>
                <span class="s2">&quot;genus&quot;</span><span class="p">,</span>
                <span class="s2">&quot;species&quot;</span><span class="p">,</span>
                <span class="s2">&quot;strain&quot;</span><span class="p">,</span>
                <span class="s2">&quot;closest_placement_reference&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">all</span>
        <span class="n">samples_csv</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;samples.csv&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">samples_csv</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying samples file from </span><span class="si">{</span><span class="n">samples_csv</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">samples_csv</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">samples_csv</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">samples_csv</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">samples_csv</span><span class="p">,</span> <span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;samples.csv&quot;</span><span class="p">)</span>

    <span class="c1"># Handle prokka_db input</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prokka_db</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying custom annotation file from </span><span class="si">{</span><span class="n">prokka_db</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">prokka_db</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">prokka_db</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">prokka_db</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">prokka_db</span><span class="p">,</span> <span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;prokka-db.csv&quot;</span><span class="p">)</span>
        <span class="n">template_dict</span><span class="p">[</span><span class="s2">&quot;prokka-db&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;prokka-db.csv&quot;</span>

    <span class="c1"># Handle gtdb_tax input</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gtdb_tax</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying custom taxonomy from </span><span class="si">{</span><span class="n">gtdb_tax</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">gtdb_tax</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">gtdb_tax</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">gtdb_tax</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">gtdb_tax</span><span class="p">,</span> <span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;gtdbtk.bac120.summary.tsv&quot;</span><span class="p">)</span>
        <span class="n">template_dict</span><span class="p">[</span><span class="s2">&quot;gtdb-tax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gtdbtk.bac120.summary.tsv&quot;</span>

    <span class="c1"># Update template_dict with project description</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">description</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Writing project description...&quot;</span><span class="p">)</span>
        <span class="n">template_dict</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

    <span class="c1"># Generate project configuration file</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project config file generated in: </span><span class="si">{</span><span class="n">project_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;project_config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">template_dict</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Initialize global config if not present</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">global_config</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="n">bgcflow_init</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span>

    <span class="c1"># Update global config.yaml with project information</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Updating global config.yaml&quot;</span><span class="p">)</span>
        <span class="n">main_config</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

        <span class="c1"># Rename &#39;pep&#39; to &#39;name&#39; for consistency</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">main_config</span><span class="p">[</span><span class="s2">&quot;projects&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s2">&quot;pep&quot;</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                <span class="n">item</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pep&quot;</span><span class="p">)</span>

        <span class="c1"># Rename &#39;pipelines&#39; to &#39;rules&#39;</span>
        <span class="k">if</span> <span class="s2">&quot;pipelines&quot;</span> <span class="ow">in</span> <span class="n">main_config</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">main_config</span><span class="p">[</span><span class="s2">&quot;rules&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_config</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;pipelines&quot;</span><span class="p">)</span>

        <span class="n">project_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">main_config</span><span class="p">[</span><span class="s2">&quot;projects&quot;</span><span class="p">]]</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">project_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">project_names</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Project name: &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39; already exists!</span><span class="se">\n</span><span class="s2">Use a different name or edit the files in: </span><span class="si">{</span><span class="n">project_dir</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;project_config.yaml&quot;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">project_names</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Project name: &#39;</span><span class="si">{</span><span class="n">project_name</span><span class="si">}</span><span class="s2">&#39; already exists!</span><span class="se">\n</span><span class="s2">Use a different name or edit the files in: </span><span class="si">{</span><span class="n">project_dir</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">main_config</span><span class="p">[</span><span class="s2">&quot;projects&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">project_dir</span> <span class="o">/</span> <span class="s2">&quot;project_config.yaml&quot;</span><span class="p">)}</span>
        <span class="p">)</span>

    <span class="c1"># Update and save global config</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;config/config.yaml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">main_config</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h3 id="bgcflow.projects_util.projects_util" class="doc doc-heading">
<code class="highlight language-python"><span class="n">projects_util</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#bgcflow.projects_util.projects_util" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Utility function for managing BGCflow projects.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>dict</code></td>
        <td><p>Keyword arguments for the function.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Keyword arguments:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bgcflow_dir</code></td>
        <td><code>str</code></td>
        <td><p>Path to the BGCflow directory.</p></td>
      </tr>
      <tr>
        <td><code>project</code></td>
        <td><code>str</code></td>
        <td><p>Name of the BGCflow project to generate.</p></td>
      </tr>
      <tr>
        <td><code>use_project_pipeline</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to use the project-specific pipeline rules.</p></td>
      </tr>
      <tr>
        <td><code>prokka_db</code></td>
        <td><code>str</code></td>
        <td><p>Path to the Prokka database.</p></td>
      </tr>
      <tr>
        <td><code>gtdb_tax</code></td>
        <td><code>str</code></td>
        <td><p>Path to the GTDB taxonomy file.</p></td>
      </tr>
      <tr>
        <td><code>samples_csv</code></td>
        <td><code>str</code></td>
        <td><p>Path to the samples CSV file.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bgcflow/projects_util.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">projects_util</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Utility function for managing BGCflow projects.</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs (dict): Keyword arguments for the function.</span>

<span class="sd">    Keyword Arguments:</span>
<span class="sd">        bgcflow_dir (str): Path to the BGCflow directory.</span>
<span class="sd">        project (str): Name of the BGCflow project to generate.</span>
<span class="sd">        use_project_pipeline (bool): Whether to use the project-specific pipeline rules.</span>
<span class="sd">        prokka_db (str): Path to the Prokka database.</span>
<span class="sd">        gtdb_tax (str): Path to the GTDB taxonomy file.</span>
<span class="sd">        samples_csv (str): Path to the samples CSV file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># pep_version = &quot;2.1.0&quot;</span>
    <span class="n">bgcflow_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;bgcflow_dir&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
    <span class="n">config_dir</span> <span class="o">=</span> <span class="n">bgcflow_dir</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
    <span class="n">config_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">global_config</span> <span class="o">=</span> <span class="n">config_dir</span> <span class="o">/</span> <span class="s2">&quot;config.yaml&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># project_name = kwargs[&quot;project&quot;]</span>

        <span class="n">generate_project</span><span class="p">(</span>
            <span class="n">bgcflow_dir</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;project&quot;</span><span class="p">],</span>
            <span class="n">use_project_rules</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;use_project_pipeline&quot;</span><span class="p">],</span>
            <span class="n">prokka_db</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;prokka_db&quot;</span><span class="p">],</span>
            <span class="n">gtdb_tax</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;gtdb_tax&quot;</span><span class="p">],</span>
            <span class="n">samples_csv</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;samples_csv&quot;</span><span class="p">],</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bgcflow_init</span><span class="p">(</span><span class="n">bgcflow_dir</span><span class="p">,</span> <span class="n">global_config</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>




  </div>

    </div>

  </div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://twitter.com/NPGMgroup" target="_blank" rel="noopener" title="@NPGMgroup" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/NBChub/bgcflow_wrapper" target="_blank" rel="noopener" title="Github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:matinnu@biosustain.dtu.dk" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.indexes", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>